{% extends 'base.html' %}
{% block content %}
<section class="text-neutral-900">
  <div class="max-w-auto mx-auto px-4 py-8">
    <h1 class="text-2xl font-primary">{{ title }}</h1>
    <form method="post" enctype="multipart/form-data" class="mt-6 space-y-6">
      {% csrf_token %}
      <input type="hidden" name="next" value="{{ next_url }}" />
      <div class="rounded-2xl bg-neutral-100 border border-neutral-200 p-5 grid grid-cols-1 md:grid-cols-5 gap-4">
        <div class="md:col-span-2" >
          <label class="{{ form.label_class }}">Maquinaria</label>
          {{ form.maquinaria }}
          {% for e in form.maquinaria.errors %}<p class="text-sm text-red-600">{{ e }}</p>{% endfor %}
        </div>

        <div class="md:col-span-3">
          <label class="{{ form.label_class }}">Título</label>
          {{ form.titulo }}
          {% for e in form.titulo.errors %}<p class="text-sm text-red-600">{{ e }}</p>{% endfor %}
        </div>
        <div class="md:col-span-3">
          <label class="{{ form.label_class }}">Parte de Equipo</label>
          {{ form.parte_equipo }}
          {% for e in form.observaciones.errors %}<p class="text-sm text-red-600">{{ e }}</p>{% endfor %}
        </div>

        <div >
          <label class="{{ form.label_class }}">Prioridad</label>
          {{ form.prioridad }}
          {% for e in form.prioridad.errors %}<p class="text-sm text-red-600">{{ e }}</p>{% endfor %}
        </div>


        <div>
          <label class="{{ form.label_class }}">Fecha programada</label>
          {{ form.fecha_programada }}
          {% for e in form.fecha_programada.errors %}<p class="text-sm text-red-600">{{ e }}</p>{% endfor %}
        </div>
        <div class="md:col-span-5">
          <label class="{{ form.label_class }}">Archivo informe</label>
          <div class="md:col-span-5 border border-neutral-400 rounded-lg">{{ form.archivo_informe }}</div>
          {% for e in form.archivo_informe.errors %}<p class="text-sm text-red-600">{{ e }}</p>{% endfor %}
        </div>
        <div class="md:col-span-5">
          <label class="{{ form.label_class }}">Descripción</label>
          {{ form.descripcion }}
          {% for e in form.descripcion.errors %}<p class="text-sm text-red-600">{{ e }}</p>{% endfor %}
        </div>

        
      </div>

      <div class="flex items-center justify-end gap-3">
        <a href="{{ next_url }}" class="h-11 px-5 rounded-xl border border-neutral-300 inline-flex items-center hover:bg-neutral-100">Cancelar</a>
        <button type="submit" class="h-11 px-6 rounded-xl bg-neutral-900 text-white font-semibold">Guardar</button>
        {% if odt %}
          <!-- botones de flujo -->
          <form method="post" action="{% url 'odt_request_review' odt.pk %}" style="display:inline;">
            {% csrf_token %}
            <button class="h-11 px-4 rounded-md bg-orange-500 text-white ml-2" type="submit">Solicitar revisión</button>
          </form>

          <form method="post" action="{% url 'odt_mark_review' odt.pk %}" style="display:inline;">
            {% csrf_token %}
            <button class="h-11 px-4 rounded-md bg-indigo-500 text-white ml-2" type="submit">Marcar revisada</button>
          </form>

          <form method="post" action="{% url 'odt_approve' odt.pk %}" style="display:inline;">
            {% csrf_token %}
            <button class="h-11 px-4 rounded-md bg-green-600 text-white ml-2" type="submit">Aprobar</button>
          </form>
        {% endif %}
      </div>
    </form>
  </div>
</section>
{% endblock %}
