{% extends 'base.html' %}
{% block content %}
<section class="text-neutral-900">
  <div class="mx-auto px-4 py-6">

    <div class="flex items-center justify-between mb-6">
      <div>
        <h1 class="text-2xl md:text-3xl font-primary">{{ title }}</h1>
        <p class="text-neutral-500 text-sm">Gestión de órdenes de trabajo</p>
      </div>

      <a href="{% url 'odt_create' %}"
         class="h-11 px-5 rounded-xl bg-green-600 text-white font-semibold hover:opacity-90">
        Nueva ODT
      </a>
    </div>

    <div class="overflow-x-auto">
      <table class="min-w-full bg-neutral-100 border border-neutral-200 rounded-xl overflow-hidden">
        <thead class="bg-slate-900 text-neutral-100">
          <tr class="text-left text-sm">
            <th class="px-4 py-3">N° ODT</th>
            <th class="px-4 py-3">Título</th>
            <th class="px-4 py-3">Maquinaria</th>
            <th class="px-4 py-3">Estado</th>
            <th class="px-4 py-3">Prioridad</th>
            <th class="px-4 py-3">Responsable</th>
            <th class="px-4 py-3 text-center">Acciones</th>
          </tr>
        </thead>

        <tbody class="divide-y divide-neutral-50">
          {% for odt in odts %}
          <tr class="hover:bg-neutral-200 text-sm">
            <td class="px-4 py-3 font-semibold">#{{ odt.n_odt|default:odt.pk }}</td>
            <td class="px-4 py-3">{{ odt.titulo }}</td>
            <td class="px-4 py-3">{{ odt.maquinaria.nombre }}</td>
            
            <td class="px-4 py-3">
              {% if odt.estado == 'BORRADOR' %}
                <span class="px-2.5 py-1 rounded-full text-xs font-semibold bg-gray-100 text-gray-700 border border-gray-300">
                  Borrador
                </span>
              {% elif odt.estado == 'SOLICITUD' %}
                <span class="px-2.5 py-1 rounded-full text-xs font-semibold bg-blue-50 text-blue-700 border border-blue-200">
                  En Solicitud
                </span>
              {% elif odt.estado == 'ASIGNADA' %}
                <span class="px-2.5 py-1 rounded-full text-xs font-semibold bg-purple-50 text-purple-700 border border-purple-200">
                  Asignada
                </span>
              {% elif odt.estado == 'EN_EJECUCION' %}
                <span class="px-2.5 py-1 rounded-full text-xs font-semibold bg-yellow-50 text-yellow-700 border border-yellow-200">
                  En Ejecución
                </span>
              {% elif odt.estado == 'REVISION' %}
                <span class="px-2.5 py-1 rounded-full text-xs font-semibold bg-orange-50 text-orange-700 border border-orange-200">
                  En Revisión
                </span>
              {% elif odt.estado == 'APROBADA' %}
                <span class="px-2.5 py-1 rounded-full text-xs font-semibold bg-green-50 text-green-700 border border-green-200">
                  Aprobada
                </span>
              {% elif odt.estado == 'CERRADA' %}
                <span class="px-2.5 py-1 rounded-full text-xs font-semibold bg-slate-100 text-slate-700 border border-slate-300">
                  Cerrada
                </span>
              {% elif odt.estado == 'RECHAZADA' %}
                <span class="px-2.5 py-1 rounded-full text-xs font-semibold bg-red-50 text-red-700 border border-red-200">
                  Rechazada
                </span>
              {% endif %}
            </td>

            <td class="px-4 py-3">
              {% if odt.prioridad == 'URGENTE' %}
                <span class="px-2 py-1 text-xs font-bold text-red-700">⚠️ URGENTE</span>
              {% elif odt.prioridad == 'ALTA' %}
                <span class="px-2 py-1 text-xs font-semibold text-orange-700">ALTA</span>
              {% elif odt.prioridad == 'MEDIA' %}
                <span class="px-2 py-1 text-xs text-yellow-700">MEDIA</span>
              {% else %}
                <span class="px-2 py-1 text-xs text-neutral-600">BAJA</span>
              {% endif %}
            </td>

            <td class="px-4 py-3">
              {{ odt.responsable_ejecucion.get_full_name|default:"—" }}
            </td>

            <td class="px-4 py-3">
              <div class="flex items-center justify-end gap-2">
                <a href="{% url 'odt_detail' odt.pk %}"
                   class="inline-flex items-center h-9 px-3 rounded-lg bg-blue-500 text-white hover:bg-blue-600 text-sm">
                  Ver
                </a>
               
              </div>
            </td>
          </tr>

          {% empty %}
          <tr>
            <td colspan="7" class="px-4 py-8 text-center text-neutral-500">
              No hay ODTs registradas.
            </td>
          </tr>
          {% endfor %}
        </tbody>

      </table>
    </div>

  </div>
</section>
{% endblock %}